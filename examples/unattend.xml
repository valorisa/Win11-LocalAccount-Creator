<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend">
    <!-- Configuration pour l'étape OOBE (Out of Box Experience) -->
    <settings pass="oobeSystem">
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <!-- Désactiver les pages OOBE inutiles -->
            <OOBE>
                <HideEULAPage>true</HideEULAPage>
                <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
                <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
                <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
                <SkipMachineOOBE>true</SkipMachineOOBE>
                <SkipUserOOBE>true</SkipUserOOBE>
            </OOBE>

            <!-- Commandes à exécuter au premier démarrage -->
            <FirstLogonCommands>
                <!-- Création du dossier Scripts si inexistant -->
                <SynchronousCommand wcm:action="add">
                    <CommandLine>cmd /c mkdir C:\Scripts</CommandLine>
                    <Description>Création du dossier Scripts</Description>
                    <Order>1</Order>
                </SynchronousCommand>

                <!-- Copie du script PowerShell depuis une source externe (ex: clé USB) -->
                <SynchronousCommand wcm:action="add">
                    <CommandLine>cmd /c copy D:\Scripts\Create-LocalAdmin.ps1 C:\Scripts\</CommandLine>
                    <Description>Copie du script PowerShell</Description>
                    <Order>2</Order>
                </SynchronousCommand>

                <!-- Exécution du script PowerShell pour créer le compte local -->
                <SynchronousCommand wcm:action="add">
                    <CommandLine>powershell.exe -ExecutionPolicy Bypass -File "C:\Scripts\Create-LocalAdmin.ps1"</CommandLine>
                    <Description>Création du compte local administrateur</Description>
                    <Order>3</Order>
                </SynchronousCommand>
            </FirstLogonCommands>
        </component>
    </settings>

    <!-- Configuration pour l'étape de spécialisation -->
    <settings pass="specialize">
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <!-- Configuration du fuseau horaire -->
            <TimeZone>Romance Standard Time</TimeZone>
        </component>
    </settings>
</unattend>
                  
